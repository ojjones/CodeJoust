<!doctype html>
<html>
<head>
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/bootstrap.js"></script>
	<script type="text/javascript" src="js/wsapi.js"></script>
	<script type="text/javascript" src="js/util.js"></script>
	<script src="ace/build/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		jQuery(function($) {
			const INIT = 0;
			const START = 1;
			const STOP = 2;

			$btnCompile = $("#btn-complile");
			$divProblemText = $("#div-problem-text");

			if (getParameterByName("problem") != undefined) {
				$(".problem-title").val(getParameterByName("problem"));
			}

			/******************************
			  IO Event Handlers
			 ******************************/

			initIOHandler = function(e) {
				$divProblemText.val(e.problem_text);
				editor.setValue(e.code_session);
			};

			startIOHandler = function(e) {
			};

			stopIOHandler = function(e) {
			};

			/******************************
			  Button Event Handlers
			 ******************************/

			compileBtnHandler = function() {
				$btnCompile.button("loading");
			};

			$btnCompile.click(compileBtnHandler);

			var editor = ace.edit("editor");
			editor.setTheme("ace/theme/monokai");
			editor.getSession().setMode("ace/mode/c_cpp");

			var ws = new WebSocket("ws://localhost:8080/team");

			ws.onbeforeunload = function(e) {
			};

			ws.onmessage = function(e) {
				data = JSON.parse(e.data);
				console.log(data);

				switch(data.type) {
					case INIT:
						initIOHandler(data);
						break;
					case START:
						startIOHandler(data);
						break;
					case STOP:
						stopIOHandler(data);
						break;
					default:
						console.log(data);

				}
			};

			ws.onopen = function() {
				msg = JSON.stringify(wsapi.INIT_REQ(parseInt(getParameterByName("game_id"))));
				console.log("Sending msg: " + msg);
				ws.send(msg);
			};

			ws.onclose = function(e) {
			};

		});
	</script>

	<link rel="stylesheet" href="css/bootstrap.css" />
	<style type="text/css">
		body {
			padding-top: 20px;
			padding-bottom: 40px;
			background-color: #eee;
		}

		#editor-container {
			height: 800px;
		}

		#editor {
			margin: 5px 0 0;
			position: absolute;
			top: 0;
			bottom: 0;
			left: 0;
			right: 0;
			font-size:24px;
		}
	</style>
</head>
<body>

	<div class="container">
		<div class="row">
			<h1><span class="problem-title">fizzbuzz</span> - Team 1</h1>
		</div>
		<div class="row">
			<button id="btn-compile" type="button" class="btn btn-primary btn-lg">Compile</button>
			<button id="btn-show-problem" type="button" class="btn btn-primary btn-lg" data-toggle="model" data-target="myModel">View Problem</button>
		</div>
		<div class="row">
			<div id="editor-container" class="col-md-12">
				<div id="editor"></div>
			</div>
		</div>
			<div class="clearfix"></div>
		<div class="row">
			<h2>Problem: <span class="problem-title">fizzbuzz<a/></h2>
			<div id="div-problem-text">
				<p>Write a program that prints the numbers from 1 to 100. But for multiples of three print 'Fizz' instead of the number and for the multiples of five print 'Buzz'. For numbers which are multiples of both three and five print 'FizzBuzz'.</p>
			</div>
		</div>
	</div>

</body>
</html>
